#!/usr/bin/env sh

# ===== Loading Scripting Additions ============

# See: https://github.com/koekeishiya/yabai/wiki/Installing-yabai-(latest-release)#macos-big-sur---automatically-load-scripting-addition-on-startup
yabai -m signal --add event=dock_did_restart action="sudo yabai --load-sa"
sudo yabai --load-sa

# yabai -m space 1 --label one
# yabai -m space 2 --label two
# yabai -m space 3 --label three
# yabai -m space 4 --label four
# yabai -m space 5 --label five
# yabai -m space 6 --label six
# yabai -m space 9 --label nine


## Change how yabai looks
yabai -m config \
  mouse_follows_focus         off             \
  focus_follows_mouse         off             \
  window_zoom_persist         off             \
  window_placement            second_child    \
  window_shadow               float           \
  window_opacity              on              \
  window_opacity_duration     0.1             \
  active_window_opacity       1.0             \
  normal_window_opacity       0.9             \
  window_animation_duration   0.2             \
  window_animation_easing     ease_out_quint  \
  insert_feedback_color       0xff9dd274      \
  split_ratio                 0.50            \
  auto_balance                off             \
  auto_padding                on              \
  mouse_modifier              fn              \
  mouse_action1               move            \
  mouse_action2               resize          \
  mouse_drop_action           swap            \
                                              \
  top_padding                 5               \
  bottom_padding              5               \
  left_padding                5               \
  right_padding               5               \
  window_gap                  5
# yabai -m config external_bar all:55:0 \

# signals
# yabai -m signal --add event=window_destroyed action="yabai -m query --windows --window &> /dev/null || yabai -m window --focus mouse"
# yabai -m signal --add event=space_changed action="yabai -m window --focus $(yabai -m query --windows --window | jq ".id")"
yabai -m signal --add event=application_terminated action="yabai -m query --windows --window &> /dev/null || yabai -m window --focus mouse"

## If I close the active window, focus on any other visible window.
yabai -m signal --add event=window_destroyed action="yabai -m query --windows --window &> /dev/null || yabai -m window --focus mouse"
yabai -m signal --add event=application_terminated action="yabai -m query --windows --window &> /dev/null || yabai -m window --focus mouse"

# Exclude problematic apps from being managed:
yabai -m rule --add app="^(Calculator|Software Update|Dictionary|System Preferences|System Settings|Karabiner-EventViewer|Photo Booth|Archive Utility|Python|App Store|Alfred|Activity Monitor)$" manage=off
yabai -m rule --add label="Finder" app="^Finder$" title="(Co(py|nnect)|Move|Info|Pref)" manage=off
yabai -m rule --add label="Safari" app="^Safari$" title="^(General|(Tab|Password|Website|Extension)s|AutoFill|Se(arch|curity)|Privacy|Advance)$" manage=off
yabai -m rule --add label="About This Mac" app="System Information" title="About This Mac" manage=off

# bsp or float (default: bsp)
yabai -m config layout bsp

#END
